import{I as g,d as K,r as p,a as R,B as J,e as s,c as C,o as b,b as e,w as o,i as T,k,h as F,M as Q,q as W,K as u,_ as X}from"./index-DuhZuMDA.js";const Y=(d,m)=>g.get(`/admin/product/baseTrademark/${d}/${m}`),Z=d=>d.id?g.put("/admin/product/baseTrademark/update",d):g.post("/admin/product/baseTrademark/save",d),ee=d=>g.delete(`/admin/product/baseTrademark/remove/${d}`),ae=["src"],te={class:"demo-pagination-block"},oe=["src"],le=K({__name:"index",setup(d){const m=p(1),v=p(3),y=p(0),U=p([]),n=p(!1),_=p(),l=R({tmName:"",logoUrl:""}),c=()=>{Y(m.value,v.value).then(t=>{y.value=t.data.total,U.value=t.data.records})};J(()=>{c()});const z=()=>{m.value=1,c()},N=()=>{n.value=!0,l.id=void 0,l.tmName="",l.logoUrl=""},V=t=>{n.value=!0,Object.assign(l,t)},h=t=>{ee(t).then(()=>{u({type:"success",message:"删除品牌成功"}),n.value=!1,c()}).catch(()=>{u({type:"error",message:"删除品牌失败"})})},O=async()=>{try{await _.value.validate(),n.value=!1,(await Z(l)).code===200?(u({type:"success",message:l.id?"修改品牌成功":"添加品牌成功"}),n.value=!1,c()):(n.value=!1,u({type:"error",message:l.id?"修改品牌失败":"添加品牌失败"}))}catch{u({type:"error",message:"请正确填写"})}},P=t=>t.type!=="image/jpeg"&&t.type!=="image/png"&&t.type!=="image/gif"?(u({type:"error",message:"请务必上传图片格式文件PNG/JPG/GIF"}),!1):t.size>4*1024*1024?(u({type:"error",message:"图片大小不能超过4M"}),!1):!0,q=t=>{l.logoUrl=t.data,_.value.clearValidate("logoUrl")},w=()=>{_.value.resetFields()},G={tmName:[{required:!0,message:"请输入品牌名称",trigger:"blur"},{required:!0,min:2,max:20,message:"品牌名称长度不能少于2个字符,不能多于20个字符",trigger:"blur"}],logoUrl:[{validator:(t,a,i)=>{a?i():i(new Error("请上传品牌LOGO"))}}]};return(t,a)=>{const i=s("el-button"),f=s("el-table-column"),M=s("el-popconfirm"),E=s("el-table"),L=s("el-pagination"),$=s("el-card"),S=s("el-input"),x=s("el-form-item"),B=s("Plus"),j=s("el-icon"),A=s("el-upload"),I=s("el-form"),D=s("el-dialog");return b(),C("div",null,[e($,{class:"box-card"},{default:o(()=>[e(i,{type:"primary",size:"default",icon:"Plus",onClick:N},{default:o(()=>a[5]||(a[5]=[k("添加品牌")])),_:1,__:[5]}),e(E,{style:{margin:"10px 0"},border:"",data:U.value},{default:o(()=>[e(f,{label:"序号",width:"80px",align:"center",type:"index"}),e(f,{prop:"tmName",label:"品牌名称"}),e(f,{label:"品牌LOGO"},{default:o(({row:r})=>[T("img",{src:r.logoUrl,alt:"未有图片",style:{width:"50px",height:"50px"}},null,8,ae)]),_:1}),e(f,{label:"品牌操作"},{default:o(({row:r})=>[e(i,{type:"primary",size:"default",icon:"Edit",onClick:H=>V(r)},null,8,["onClick"]),e(M,{title:"您确定删除该品牌吗？",width:"200px",onConfirm:H=>h(r.id)},{reference:o(()=>[e(i,{type:"danger",size:"default",icon:"Delete"})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"]),T("div",te,[e(L,{"current-page":m.value,"onUpdate:currentPage":a[0]||(a[0]=r=>m.value=r),"page-size":v.value,"onUpdate:pageSize":a[1]||(a[1]=r=>v.value=r),"page-sizes":[3,5,7,9],disabled:!1,background:!0,layout:"prev, pager, next, jumper, ->, sizes, total",total:y.value,onCurrentChange:c,onSizeChange:z},null,8,["current-page","page-size","total"])])]),_:1}),e(D,{modelValue:n.value,"onUpdate:modelValue":a[4]||(a[4]=r=>n.value=r),title:l.id?"修改品牌":"添加品牌",onClosed:w},{footer:o(()=>[e(i,{type:"primary",onClick:O},{default:o(()=>a[6]||(a[6]=[k("确定")])),_:1,__:[6]}),e(i,{onClick:a[3]||(a[3]=r=>n.value=!1)},{default:o(()=>a[7]||(a[7]=[k("取消")])),_:1,__:[7]})]),default:o(()=>[e(I,{style:{width:"80%"},"label-width":"auto","label-position":"left",model:l,rules:G,ref_key:"formRef",ref:_},{default:o(()=>[e(x,{label:"品牌名称",prop:"tmName"},{default:o(()=>[e(S,{placeholder:"请输入品牌名称",modelValue:l.tmName,"onUpdate:modelValue":a[2]||(a[2]=r=>l.tmName=r)},null,8,["modelValue"])]),_:1}),e(x,{label:"品牌LOGO",prop:"logoUrl"},{default:o(()=>[e(A,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":q,"before-upload":P,headers:{token:F(Q)()}},{default:o(()=>[l.logoUrl?(b(),C("img",{key:0,src:l.logoUrl,class:"avatar"},null,8,oe)):(b(),W(j,{key:1,class:"avatar-uploader-icon"},{default:o(()=>[e(B)]),_:1}))]),_:1},8,["headers"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ne=X(le,[["__scopeId","data-v-d053bf6b"]]);export{ne as default};
