import{I as c,d as B,r as _,B as P,K as s,e as i,c as E,o as I,b as o,w as n,n as f,k as u,t as N,v as b}from"./index-DuhZuMDA.js";const S=()=>c.get("/admin/acl/permission"),F=d=>d.id?c.put("/admin/acl/permission/update",d):c.post("/admin/acl/permission/save",d),H=d=>c.delete(`/admin/acl/permission/remove/${d}`),O=B({__name:"index",setup(d){const g=_([]);P(()=>{v()});const v=()=>{S().then(l=>{l.code===200?g.value=l.data:s.error("获取用户信息列表失败，"+l.message)}).catch(l=>{s.error("获取用户信息列表失败，"+l.message)})},m=_(!1),a=_({id:"",name:"",code:"",level:0,pid:0,type:0}),k=l=>{a.value=l,m.value=!0},x=l=>{a.value.level=l.level+1,a.value.pid=l.id,m.value=!0},$=()=>{a.value={id:"",name:"",code:"",level:0,pid:0,type:0}},M=()=>{F(a.value).then(l=>{l.code===200?(s.success({message:a.value.id?"修改菜单成功":"添加菜单成功"}),m.value=!1,v()):s.error({message:a.value.id?"修改菜单失败":"添加菜单失败"})}).catch(l=>{s.error("请求失败，"+l.message)})},q=l=>{H(l.id).then(e=>{e.code===200?(s.success("删除菜单成功"),v()):s.error("删除菜单失败")}).catch(e=>{s.error("请求失败，"+e.message)})};return(l,e)=>{const p=i("el-table-column"),r=i("el-button"),D=i("el-popconfirm"),U=i("el-table"),y=i("el-input"),C=i("el-form-item"),z=i("el-form"),A=i("el-dialog");return I(),E("div",null,[o(U,{data:g.value,style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:""},{default:n(()=>[o(p,{prop:"name",label:"名称"}),o(p,{prop:"id",label:"ID"}),o(p,{prop:"code",label:"权限值"}),o(p,{label:"操作"},{default:n(({row:t})=>[f(o(r,{type:"primary",size:"small",onClick:V=>x(t)},{default:n(()=>[u(N(t.level===3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick"]),[[b,t.level!==4]]),f(o(r,{type:"primary",size:"small",onClick:V=>k(t)},{default:n(()=>e[4]||(e[4]=[u("编辑")])),_:2,__:[4]},1032,["onClick"]),[[b,t.level!==1]]),o(D,{title:`您确定删除用户${t.name}吗?`,width:"260px",onConfirm:V=>q(t)},{reference:n(()=>[f(o(r,{type:"primary",size:"small",title:"删除用户"},{default:n(()=>e[5]||(e[5]=[u("删除")])),_:2,__:[5]},1536),[[b,t.level!==1]])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),o(A,{modelValue:m.value,"onUpdate:modelValue":e[3]||(e[3]=t=>m.value=t),title:a.value.id?"修改菜单":"添加菜单",onClosed:$},{footer:n(()=>[o(r,{onClick:e[2]||(e[2]=t=>m.value=!1)},{default:n(()=>e[6]||(e[6]=[u("取消")])),_:1,__:[6]}),o(r,{type:"primary",onClick:M},{default:n(()=>e[7]||(e[7]=[u("确定")])),_:1,__:[7]})]),default:n(()=>[o(z,{"label-width":"auto","label-position":"left",model:a.value},{default:n(()=>[o(C,{label:"名称",prop:"name"},{default:n(()=>[o(y,{placeholder:"请输入名称",modelValue:a.value.name,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.name=t)},null,8,["modelValue"])]),_:1}),o(C,{label:"权限值",prop:"code"},{default:n(()=>[o(y,{placeholder:"请输入权限值",modelValue:a.value.code,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.code=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{O as default};
